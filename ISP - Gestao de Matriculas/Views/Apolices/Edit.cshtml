@model ISP.GestaoMatriculas.ViewModels.ApoliceEditViewModel

@{
<<<<<<< HEAD
    ViewBag.Title = "Editar " + Html.DisplayFor(model => model.apolice.numeroApolice) + " " + Html.DisplayFor(model => model.veiculo.numeroMatricula);
}

@section css{
	@Styles.Render("~/Content/myWizardFuelux/css")
}

@section scripts{		

	@Scripts.Render("~/bundles/myWizardFuelux");	
    	
=======
	ViewBag.Title = "Edit";
}

@section css{
	@Styles.Render("~/Content/fuelux/css")
}

@section scripts{
			
	@Styles.Render("~/Content/myWizardFuelux/css")
		
>>>>>>> 6bef4ea7199f182f1dcc5a1156a157494ff9f29c
		<script type='text/javascript'>
			
			$(function () {
				$('#tabs a:first').tab('show')
<<<<<<< HEAD
            });

            $(document).ready(function () {
                $('#rootwizard').bootstrapWizard({
                    tabClass: 'steps',
                    onTabShow: function (tab, navigation, index) {
                        var $total = navigation.find('li').length;
                        var $current = index + 1;

                        // If it's the last tab then hide the last button and show the finish instead
                        if ($current >= $total) {
                            $('#rootwizard').find('.wizard-buttons .next').hide();
                            $('#rootwizard').find('.wizard-buttons .finish').show();
                            $('#rootwizard').find('.wizard-buttons .finish').removeClass('disabled');
                        } else {
                            $('#rootwizard').find('.wizard-buttons .next').show();
                            $('#rootwizard').find('.wizard-buttons .finish').hide();
                        }
                    }
                });

                $('#rootwizard .finish').click(function () {
                    $('#ApoliceForm').submit();
                });
            });
            	
		</script>
}

<h2>Editar @Html.DisplayFor(model => model.apolice.numeroApolice)</h2>
<h4>(@Html.DisplayFor(model => model.veiculo.numeroMatricula), 
@Html.DisplayFor(model => model.apolice.entidade.nome), @Html.DisplayFor(model => model.apolice.dataInicio))</h4>

<ul id="tabs" class="nav nav-tabs">
  <li><a href="#editarTab" data-toggle="tab">Detalhes</a></li>
  <li><a href="#historicoTab" data-toggle="tab">Histórico 
  @if (Model.historicoApolices.Count() > 0)
  {
      <span class="badge badge-info">@Model.historicoApolices.Count()</span>
  }
      </a></li>
  <li><a href="#avisosTab" data-toggle="tab">Avisos 
  @if (Model.apolice.avisosApolice.Count > 0)
  {
      <span class="badge badge-warning">@Model.apolice.avisosApolice.Count</span>
  }</a></li>
=======
			});


			$(document).ready(function () {

				var $wizard = $('#MyWizard').wizard();
				var wizard = $wizard.data('wizard');
				$wizard.off('click', 'li.complete');
				$wizard.on('click', 'li', $.proxy(wizard.stepclicked, wizard));

				$('#MyWizard').on('change', function (e, data) {
				});

				$('#MyWizard').on('changed', function (e, data) {
					//                    console.log('changed');

					$("#MyWizard ul.steps").find("li").addClass("complete");
					$("#MyWizard ul.steps").find("span.badge").addClass("badge-success");
					
					var item = $('#MyWizard').wizard('selectedItem');
					//console.log(item.step);
					if (item.step === 5) {
						$('#btnWizardNext').attr('value', 'Guardar'); ;
					}
					else {
						$('#btnWizardNext').attr('value', 'Próximo'); ;
					}

				});
				$('#MyWizard').on('finished', function (e, data) {
					//                    console.log('finished');
					$('#ApoliceForm').submit();
				});
				$('#btnWizardPrev').on('click', function () {
					$('#MyWizard').wizard('previous');
				});
				$('#btnWizardNext').on('click', function () {
					$('#MyWizard').wizard('next', 'foo');
				});
				$('#btnWizardStep').on('click', function () {
					var item = $('#MyWizard').wizard('selectedItem');
					//                    console.log(item.step);
				});
				$('#btnWizardSave').on('click', function () {
					$('#ApoliceForm').submit();
				});
				$('#MyWizard').on('stepclick', function (e, data) {
					//                    console.log('step' + data.step + ' clicked');
					if (data.step === 1) {
						// return e.preventDefault();
					}
				});
			});
		
		</script>
}

<h2>Edit</h2>

<ul id="tabs" class="nav nav-tabs">
  <li><a href="#editarTab" data-toggle="tab">Editar</a></li>
  <li><a href="#historicoTab" data-toggle="tab">Histórico</a></li>
  <li><a href="#avisosTab" data-toggle="tab">Avisos</a></li>
>>>>>>> 6bef4ea7199f182f1dcc5a1156a157494ff9f29c
</ul>

<div class="tab-content">

<div class="tab-pane active" id="editarTab">
@using (Html.BeginForm("Edit", "Apolices", FormMethod.Post, new {@id = "ApoliceForm"})) {
	@Html.ValidationSummary(true)
	@Html.AntiForgeryToken()

	<fieldset>
<<<<<<< HEAD

    <div id="rootwizard" class ="well fuelux">
	  <div class="wizard">
	<ul class="steps">
	  	<a href="#periodo" data-toggle="tab"><li class="active"><span class="badge badge-info">1</span> Período Seguro <span class="chevron"> </span></li></a>
		<a href="#veiculo" data-toggle="tab"><li class="complete"><span class="badge badge-success">2</span> Veículo <span class="chevron"> </span></li></a>
		<a href="#tomador" data-toggle="tab"><li class="complete last"><span class="badge badge-success">3</span> Tomador de Seguro<span class="chevron"> </span></li></a>
	</ul>
	</div>

    	<div class="tab-content">
	        <div class="tab-pane" id="periodo">
                <legend>Período Seguro</legend>
			    <div class="editor-field">
			    @Html.HiddenFor(model => model.apolice.apoliceId)
			    </div>
			    <div class="editor-field">
			    @Html.HiddenFor(model => model.apolice.entidadeId)
			    </div>
			    <div class="editor-label">
				    @Html.LabelFor(model => model.apolice.numeroApolice)
			    </div>
			    <div class="editor-field">
				    @Html.EditorFor(model => model.apolice.numeroApolice)
				    @Html.ValidationMessageFor(model => model.apolice.numeroApolice)
			    </div>
			    <div class="editor-label">
				    @Html.LabelFor(model => model.apolice.dataInicio)
			    </div>
			    <div class="editor-field">
				    @Html.HiddenFor(model => model.apolice.dataInicio)
                    @Html.DisplayFor(model => model.apolice.dataInicio)
				    @Html.ValidationMessageFor(model => model.apolice.dataInicio)
			    </div>

			    <div class="editor-label">
				    @Html.LabelFor(model => model.apolice.dataFim)
			    </div>
			    <div class="editor-field">
				    @Html.HiddenFor(model => model.apolice.dataFim)
                    @Html.DisplayFor(model => model.apolice.dataFim)
				    @Html.ValidationMessageFor(model => model.apolice.dataFim)
			    </div>
                <div class="editor-label">
				    @Html.LabelFor(model => model.apolice.numeroCertificadoProvisorio)
			    </div>
			    <div class="editor-field">
				    @Html.EditorFor(model => model.apolice.numeroCertificadoProvisorio)
				    @Html.ValidationMessageFor(model => model.apolice.numeroCertificadoProvisorio)
			    </div>
            </div>
            <div class="tab-pane" id="veiculo">
                <legend>Veículo</legend>
=======
	<div id="rootwizard" class="fuelux well">
	  <div class="wizard">
	<ul class="steps">
		<a class="active" href="#tab1" data-toggle="tab"><li class="active"><span class="badge badge-info">1</span> Período Segurado <span class="chevron"> </span></li></a>
		<a href="#tab2" data-toggle="tab"><li class="complete"><span class="badge badge-success">2</span> Veículo <span class="chevron"> </span></li></a>
		<a href="#tab3" data-toggle="tab"><li class="complete"><span class="badge badge-success">3</span> Tomador de Seguro<span class="chevron"> </span></li></a>
	</ul>
	</div>

	<div class="tab-content">
		<div class="tab-pane" id="tab1">
			<legend>Período Segurado</legend>
			<div class="editor-field">
			@Html.HiddenFor(model => model.apolice.apoliceId)
			</div>
			<div class="editor-field">
			@Html.HiddenFor(model => model.apolice.entidadeId)
			</div>
			<div class="editor-label">
				@Html.LabelFor(model => model.apolice.numeroApolice)
			</div>
			<div class="editor-field">
				@Html.EditorFor(model => model.apolice.numeroApolice)
				@Html.ValidationMessageFor(model => model.apolice.numeroApolice)
			</div>
			<div class="editor-label">
				@Html.LabelFor(model => model.apolice.dataInicio)
			</div>
			<div class="editor-field">
				@Html.EditorFor(model => model.apolice.dataInicio)
				@Html.ValidationMessageFor(model => model.apolice.dataInicio)
			</div>

			<div class="editor-label">
				@Html.LabelFor(model => model.apolice.dataFim)
			</div>
			<div class="editor-field">
				@Html.EditorFor(model => model.apolice.dataFim)
				@Html.ValidationMessageFor(model => model.apolice.dataFim)
			</div>
			</div>

		<div class="tab-pane" id="tab2">
				<legend>Veículo</legend>
>>>>>>> 6bef4ea7199f182f1dcc5a1156a157494ff9f29c
				<div class="editor-field">
				@Html.HiddenFor(model => model.veiculo.veiculoId)
				</div>
				<div class="editor-label">
					@Html.LabelFor(model => model.veiculo.categoriaId, "Categoria")
				</div>
				<div class="editor-field">
					@Html.DropDownList("categoriaId", (SelectList) ViewData["Categorias"])
					@Html.ValidationMessageFor(model => model.veiculo.categoriaId)
				</div>
				<div class="editor-label">
					@Html.LabelFor(model => model.veiculo.numeroMatricula)
				</div>
				<div class="editor-field">
<<<<<<< HEAD
					@Html.HiddenFor(model => model.veiculo.numeroMatricula)
                    @Html.DisplayFor(model => model.veiculo.numeroMatricula)
=======
					@Html.EditorFor(model => model.veiculo.numeroMatricula)
>>>>>>> 6bef4ea7199f182f1dcc5a1156a157494ff9f29c
					@Html.ValidationMessageFor(model => model.veiculo.numeroMatricula)
				</div>
				<div class="editor-label">
					@Html.LabelFor(model => model.veiculo.anoConstrucao)
				</div>
				<div class="editor-field">
					@Html.EditorFor(model => model.veiculo.anoConstrucao)
					@Html.ValidationMessageFor(model => model.veiculo.anoConstrucao)
				</div>
				<div class="editor-label">
					@Html.LabelFor(model => model.veiculo.marcaVeiculo)
				</div>
				<div class="editor-field">
					@Html.EditorFor(model => model.veiculo.marcaVeiculo)
					@Html.ValidationMessageFor(model => model.veiculo.marcaVeiculo)
				</div>
				<div class="editor-label">
					@Html.LabelFor(model => model.veiculo.modeloVeiculo)
				</div>
				<div class="editor-field">
					@Html.EditorFor(model => model.veiculo.modeloVeiculo)
					@Html.ValidationMessageFor(model => model.veiculo.modeloVeiculo)
				</div>
				<div class="editor-label">
					@Html.LabelFor(model => model.apolice.concelhoCirculacaoId, "Concelho")
				</div>
				<div class="editor-field">
					@Html.DropDownList("concelhoId", (SelectList) ViewData["Concelhos"])
					@Html.ValidationMessageFor(model => model.apolice.concelhoCirculacaoId)
				</div>
<<<<<<< HEAD
            </div>
            <div class="tab-pane" id="tomador">
                <legend>Tomador do Seguro</legend>
=======

				</div>
		<div class="tab-pane" id="tab3">
				<legend>Tomador do Seguro</legend>
>>>>>>> 6bef4ea7199f182f1dcc5a1156a157494ff9f29c
				<div class="editor-field">
				@Html.HiddenFor(model => model.tomador.pessoaId)
				</div>
				<div class="editor-label">
					@Html.LabelFor(model => model.tomador.nome)
				</div>
				<div class="editor-field">
					@Html.EditorFor(model => model.tomador.nome)
					@Html.ValidationMessageFor(model => model.tomador.nome)
				</div>
				<div class="editor-label">
					@Html.LabelFor(model => model.tomador.numeroIdentificacao)
				</div>
				<div class="editor-field">
					@Html.EditorFor(model => model.tomador.numeroIdentificacao)
					@Html.ValidationMessageFor(model => model.tomador.numeroIdentificacao)
				</div>
				<div class="editor-label">
					@Html.LabelFor(model => model.tomador.nif)
				</div>
				<div class="editor-field">
					@Html.EditorFor(model => model.tomador.nif)
					@Html.ValidationMessageFor(model => model.tomador.nif)
				</div>
<<<<<<< HEAD
                <div class="editor-label">
					@Html.LabelFor(model => model.tomador.morada)
				</div>
				<div class="editor-field">
					@Html.EditorFor(model => model.tomador.morada)
					@Html.ValidationMessageFor(model => model.tomador.morada)
				</div>
                <div class="editor-label">
					@Html.LabelFor(model => model.tomador.codigoPostal)
				</div>
				<div class="editor-field">
					@Html.EditorFor(model => model.tomador.codigoPostal)
					@Html.ValidationMessageFor(model => model.tomador.codigoPostal)
				</div>
            </div>
            <div class="wizard-buttons">
			        @*<li class="previous first" style="display:none;"><a href="#">Primeiro</a></li>*@
			        <li class="previous"><a href="#">Anterior</a></li>
			        @*<li class="next last" style="display:none;"><a href="#">Último</a></li>*@
		  	        <li class="next"><a href="#">Próximo</a></li>
                    <li class="next finish" style="display:none;"><a href="javascript:;">Guardar</a></li>
		</div>
    </div>	
=======

				</div>
		<ul class="pager wizard">
			<li class="previous first" style="display:none;"><a href="#">First</a></li>
			<li class="previous"><a href="#">Previous</a></li>
			<li class="next last" style="display:none;"><a href="#">Last</a></li>
			<li class="next"><a href="#">Next</a></li>
		</ul>

	</div>	

	<div class ="container"><input type="button" class="btn btn-primary" id="btnWizardSave" value="Guardar">
>>>>>>> 6bef4ea7199f182f1dcc5a1156a157494ff9f29c
	</fieldset>
}

</div>
<div class="tab-pane" id="historicoTab">
<<<<<<< HEAD
	<div class="well fuelux">
 @if (Model.historicoApolices.Count() != 0)
 { 
    <table class="table table-striped table-hover">
    <thead>
=======
	<div class="well">
 @if (Model.historicoApolices.Count() != 0)
 { 
    <table>
>>>>>>> 6bef4ea7199f182f1dcc5a1156a157494ff9f29c
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.historicoApolices.First().entidade)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.historicoApolices.First().numeroApolice)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.historicoApolices.First().dataInicio)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.historicoApolices.First().dataFim)
        </th>
        <th>
        @Html.DisplayNameFor(model => model.historicoApolices.First().veiculo.numeroMatricula)
        </th>
        <th>
        @Html.DisplayNameFor(model => model.historicoApolices.First().tomador.nome)
        </th>
        <th>
        @Html.DisplayNameFor(model => model.historicoApolices.First().concelho)
        </th>
        <th></th>
    </tr>
<<<<<<< HEAD
    </thead>
    <tbody>
@foreach (var item in Model.historicoApolices)
{
    
=======

@foreach (var item in Model.historicoApolices)
{
>>>>>>> 6bef4ea7199f182f1dcc5a1156a157494ff9f29c
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.entidade.nome)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.numeroApolice)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.dataInicio)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.dataFim)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.veiculo.numeroMatricula)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.tomador.nome)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.concelho.nomeConcelho)
        </td>
        <td>
            @Html.ActionLink("Detalhes", "DetalhesHistorico", new { id = item.apoliceId })
        </td>
    </tr>
<<<<<<< HEAD
    
}
</tbody>
</table>
 }
 else
 { 
=======
}

</table>
 }
 else { 
>>>>>>> 6bef4ea7199f182f1dcc5a1156a157494ff9f29c
 <div>Não existe histórico.</div>
 }
	</div>
</div>
<div class="tab-pane" id="avisosTab">
<<<<<<< HEAD
	<div class="well fuelux">
		@if (Model.apolice.avisosApolice.Count() != 0)
  { 
        <table class="table table-striped table-hover">
        <thead>
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.apolice.avisosApolice.First().campo)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.apolice.avisosApolice.First().descricao)
        </th>        
        <th></th>
    </tr>
    </thead>
        <tbody>
        @foreach (var item in Model.apolice.avisosApolice)
        {
            
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.campo)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.descricao)
                </td>
            </tr>
            
        }
        </tbody>
        </table>
  }
  else
  { 
            <div>Não existem avisos.</div>
  }
=======
	<div class="well">
		Avisos
>>>>>>> 6bef4ea7199f182f1dcc5a1156a157494ff9f29c
	</div>
</div>

</div>
<div>
	@Html.ActionLink("Voltar à listagem", "Index")
</div>

